{% macro render_blog_post(post, from_index=false) %}
<article class="post">
  {% if from_index %}
    <h2 class="post-title"><a href="{{ post|url }}">{{ post.title }}</a></h2>
  {% else %}
    <h1 class="post-title">{{ post.title }}</h1>
  {% endif %}
  <p class="post-meta">
    By
    {% if post.twitter_handle %}
      <a class="post-author" href="https://twitter.com/{{ post.twitter_handle }}">{{ post.author or post.twitter_handle }}</a>
    {% else %}
      <span class="post-author">{{ post.author }}</span>
    {% endif %}
    &middot; {{ post.pub_date.strftime('%B %d, %Y') }}
  </p>
  {% if not from_index and post.body.toc %}
  <nav class="toc-container">
    <h4>Table of Contents</h4>
    <ul class="toc">
    {% for item in post.body.toc recursive %}
      <li><a href="#{{ item.anchor }}">{{ item.title }}</a>
      {%- if item.children %}<ul>{{ loop(item.children) }}</ul>{% endif %}</li>
    {% endfor %}
    </ul>
  </nav>
  {% endif %}
  <div class="post-body">
    {{ post.body }}
  </div>
</article>
{% endmacro %}
